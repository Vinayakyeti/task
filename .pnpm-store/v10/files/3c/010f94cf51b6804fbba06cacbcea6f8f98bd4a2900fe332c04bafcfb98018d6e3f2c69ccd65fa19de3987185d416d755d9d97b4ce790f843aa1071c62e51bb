{"version":3,"file":"getMetaBySegment.js","names":["getNextRequestI18n","generateAPIViewMetadata","generateEditViewMetadata","generateLivePreviewViewMetadata","generateNotFoundViewMetadata","generateVersionViewMetadata","generateVersionsViewMetadata","getViewsFromConfig","getMetaBySegment","collectionConfig","config","globalConfig","params","segments","fn","segmentOne","isCollection","isGlobal","isEditing","Boolean","length","i18n","viewKey","overrideDocPermissions","routeSegments","customViewConfig","admin","components","views","edit","view"],"sources":["../../../src/views/Document/getMetaBySegment.tsx"],"sourcesContent":["import type { Metadata } from 'next'\nimport type { EditConfig, SanitizedCollectionConfig, SanitizedGlobalConfig } from 'payload'\n\nimport type { GenerateViewMetadata } from '../Root/index.js'\n\nimport { getNextRequestI18n } from '../../utilities/getNextRequestI18n.js'\nimport { generateAPIViewMetadata } from '../API/metadata.js'\nimport { generateEditViewMetadata } from '../Edit/metadata.js'\nimport { generateLivePreviewViewMetadata } from '../LivePreview/metadata.js'\nimport { generateNotFoundViewMetadata } from '../NotFound/metadata.js'\nimport { generateVersionViewMetadata } from '../Version/metadata.js'\nimport { generateVersionsViewMetadata } from '../Versions/metadata.js'\nimport { getViewsFromConfig } from './getViewsFromConfig.js'\n\nexport type GenerateEditViewMetadata = (\n  args: {\n    collectionConfig?: null | SanitizedCollectionConfig\n    globalConfig?: null | SanitizedGlobalConfig\n    view?: keyof EditConfig\n  } & Parameters<GenerateViewMetadata>[0],\n) => Promise<Metadata>\n\nexport const getMetaBySegment: GenerateEditViewMetadata = async ({\n  collectionConfig,\n  config,\n  globalConfig,\n  params,\n}) => {\n  const { segments } = params\n\n  let fn: GenerateEditViewMetadata | null = null\n\n  const [segmentOne] = segments\n  const isCollection = segmentOne === 'collections'\n  const isGlobal = segmentOne === 'globals'\n\n  const isEditing =\n    isGlobal || Boolean(isCollection && segments?.length > 2 && segments[2] !== 'create')\n\n  if (isCollection) {\n    // `/:collection/:id`\n    if (params.segments.length === 3) {\n      fn = generateEditViewMetadata\n    }\n\n    // `/:collection/:id/:view`\n    if (params.segments.length === 4) {\n      switch (params.segments[3]) {\n        case 'api':\n          // `/:collection/:id/api`\n          fn = generateAPIViewMetadata\n          break\n        case 'preview':\n          // `/:collection/:id/preview`\n          fn = generateLivePreviewViewMetadata\n          break\n        case 'versions':\n          // `/:collection/:id/versions`\n          fn = generateVersionsViewMetadata\n          break\n        default:\n          break\n      }\n    }\n\n    // `/:collection/:id/:slug-1/:slug-2`\n    if (params.segments.length === 5) {\n      switch (params.segments[3]) {\n        case 'versions':\n          // `/:collection/:id/versions/:version`\n          fn = generateVersionViewMetadata\n          break\n        default:\n          break\n      }\n    }\n  }\n\n  if (isGlobal) {\n    // `/:global`\n    if (params.segments?.length === 2) {\n      fn = generateEditViewMetadata\n    }\n\n    // `/:global/:view`\n    if (params.segments?.length === 3) {\n      switch (params.segments[2]) {\n        case 'api':\n          // `/:global/api`\n          fn = generateAPIViewMetadata\n          break\n        case 'preview':\n          // `/:global/preview`\n          fn = generateLivePreviewViewMetadata\n          break\n        case 'versions':\n          // `/:global/versions`\n          fn = generateVersionsViewMetadata\n          break\n        default:\n          break\n      }\n    }\n\n    // `/:global/versions/:version`\n    if (params.segments?.length === 4 && params.segments[2] === 'versions') {\n      fn = generateVersionViewMetadata\n    }\n  }\n\n  const i18n = await getNextRequestI18n({\n    config,\n  })\n\n  if (typeof fn === 'function') {\n    return fn({\n      collectionConfig,\n      config,\n      globalConfig,\n      i18n,\n      isEditing,\n    })\n  } else {\n    const { viewKey } = getViewsFromConfig({\n      collectionConfig,\n      config,\n      globalConfig,\n      overrideDocPermissions: true,\n      routeSegments: typeof segments === 'string' ? [segments] : segments,\n    })\n\n    if (viewKey) {\n      const customViewConfig =\n        collectionConfig?.admin?.components?.views?.edit?.[viewKey] ||\n        globalConfig?.admin?.components?.views?.edit?.[viewKey]\n\n      if (customViewConfig) {\n        return generateEditViewMetadata({\n          collectionConfig,\n          config,\n          globalConfig,\n          i18n,\n          isEditing,\n          view: viewKey as keyof EditConfig,\n        })\n      }\n    }\n  }\n\n  return generateNotFoundViewMetadata({ config, i18n })\n}\n"],"mappings":"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","ignoreList":[]}